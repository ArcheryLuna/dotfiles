function T(t){if(typeof document!="undefined"){var r=document.createElement("style"),n=document.createTextNode(t);r.appendChild(n),document.head.appendChild(r)}}var P=`.cell-output-ipywidget-background{background:white!important}
`;T(P);var y=class{constructor(r=null){this.scope=r;this._resolved=!1;this._rejected=!1;this._promise=new Promise((n,i)=>{this._resolve=n,this._reject=i})}get value(){return this._value}resolve(r){this._value=r,this._resolve.apply(this.scope?this.scope:this,arguments),this._resolved=!0}reject(r){this._reject.apply(this.scope?this.scope:this,arguments),this._rejected=!0}get promise(){return this._promise}get resolved(){return this._resolved}get rejected(){return this._rejected}get completed(){return this._rejected||this._resolved}};function w(t=null){return new y(t)}var v;function h(t){v&&v("error",t)}function _(t){return t.mime.toLowerCase().includes("json")?t.json():t.text()}var c=class extends Error{constructor(){super(),this.name="vscode.fallbackToNextRenderer"}};async function k(){return new Promise(r=>{let n=()=>{var u,e;let i=((u=window.ipywidgetsKernel)==null?void 0:u.renderOutput)||((e=this.ipywidgetsKernel)==null?void 0:e.renderOutput);i?(window.ipywidgetsKernel.initialize(),r(i)):setTimeout(n,100)};n()})}var H=t=>{let r=(e,o)=>{t.postMessage&&t.postMessage({command:"log",message:e,category:o}),o==="error"&&console.error(e)};r("Jupyter IPyWidget Renderer Activated"),M(t);let n=new Map,i=w();t.postMessage&&t.postMessage({command:"ipywidget-renderer-loaded"}),t.onDidReceiveMessage&&t.onDidReceiveMessage(async e=>{var o;if(e.command==="query-widget-state"&&e.model_id&&((o=n.get(e.model_id))==null||o.resolve(e),n.delete(e.model_id)),e.command==="ipywidget-renderer-init"){let d=window.ipywidgetsKernel;if(e.version){let s=new Promise(a=>{let l=()=>{if(window.vscIPyWidgets7)return a();setTimeout(l,500)};setTimeout(l,500)}),g=new Promise(a=>{let l=()=>{if(window.vscIPyWidgets8)return a();setTimeout(l,500)};setTimeout(l,500)});await Promise.all([s,g]);let m=()=>{try{window.vscIPyWidgets8.unload()}catch(a){}},p=()=>{try{window.vscIPyWidgets7.unload()}catch(a){}};e.version===7?(m(),window.vscIPyWidgets7.load(),r("Loaded IPYWidgets 7.x","info")):e.version===8&&(p(),window.vscIPyWidgets8.load(),r("Loaded IPYWidgets 8.x","info"))}e.widgetState&&d&&e.version?(await d.restoreWidgets(e.widgetState),i.resolve(Object.assign({},e,{widgetStateLoaded:!0}))):i.resolve(Object.assign({},e,{widgetStateLoaded:!1}))}});async function u(e){if(!t.postMessage)return{hasWidgetState:!1,kernelSelected:!1};let o=n.get(e)||w();return n.set(e,o),t.postMessage({command:"query-widget-state",model_id:e}),o.promise}return{async renderOutputItem(e,o,d){r(`Got item for Rendering ${e.id}}`);try{let s=_(e);if(!s)throw r(`Error: Model not found to render output ${e.id}`,"error"),new c;let g=k(),{hasWidgetState:m,kernelSelected:p}=await u(s.model_id),a=m&&p?await g:void 0;if(!m)throw r(`Model not found in Kernel state to render output ${e.id}, rendering a fallback mime type`,"info"),new c;if(!p)throw r(`No Kernel selected, hence not rendering widget output ${e.id}`,"error"),new c;if(a)return r(`Rendering ${e.id} widget renderer found *************`),o.className=(o.className||"")+" cell-output-ipywidget-background",a(e,s,o,r,u);throw new c}catch(s){throw h(`Failed to render output ${e.id}, ${s}`),s}finally{O(t,e,o)}},disposeOutputItem(e){var d,s;r(`Disposing rendered output for ${e}`);let o=((d=window.ipywidgetsKernel)==null?void 0:d.disposeOutput)||((s=this.ipywidgetsKernel)==null?void 0:s.disposeOutput);if(o)return o(e)}}};function M(t){let r=window;if(!r.widgetEntryPoint||typeof r.widgetEntryPoint.initialize!="function"){t.postMessage&&t.postMessage({command:"log",message:"Hook not registered"});return}r.widgetEntryPoint.initialize(t)}function O(t,r,n){let i=window;!i.widgetEntryPoint||typeof i.widgetEntryPoint.renderOutputItem!="function"||(t.postMessage&&t.postMessage({command:"log",message:"rendering output"}),i.widgetEntryPoint.renderOutputItem(r,n))}export{H as activate};
